<!--@layout(/layout/basic/layout.html)-->
<div class="section" module="board_ReadPackage_9">
    <!--@css(/css/module/board/readPackage_9.css)-->
    <div class="qna_tab">
        <a class="qna_write" href="/board/consult/write.html">문의하기</a>
        <a class="qna_list active" href="/myshop/board_list.html">문의 내역</a>
    </div>

    <div module="Board_Read_9" style="margin-top: 20px;">
        <!--
            $delete_success_url = /board/consult/list.html
            $login_page_url = /member/login.html
        -->
        <div class="ec-base-table gLayoutFixed">
            <div class="qna_contents_wrap">
                <div class="qna_q_wrap">
                    <p class="q_before">Q.</p>
                    <div class="q_data_list">
                        <h2 class="q_title">{$subject}</h2>
                        <div class="q_meta">
                            <span class="q_category">{$category_name}</span>
                            <span class="q_dot">·</span>
                            <span class="q_date">{$write_date}</span>
                            <div class="row-reply" style="display: none;">
                                <p scope="row">답변여부</p>
                                <p class="reply-state">{$consult}</p>
                            </div>
                        </div>
                        <div class="q_content_main">{$content}</div>
                        <div class="relation_prd"></div>
                        <div class="file_list">{$attach_file}</div>
                    </div>
                </div>
                <div class="qna_a_wrap">
                    <p class="a_before">A.</p>
                    <div class="a_content_main">{$reply_content}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const esc = s => String(s||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  const $  = (s,r=document)=>r.querySelector(s);
  const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

  (function cleanEmptyParagraphs(){
    $$('.q_content_main p, .a_content_main p').forEach(p=>{
      const txt = (p.textContent || '').replace(/\u200B|\u00A0/g,'').trim();
      if (!txt && p.querySelector('br')) {
        p.remove();
      }
    });
  })();

  (function renderLinkedProductCard(){
    const article = $('.q_content_main') || $('.xans-board-read .detail, .xans-board-read .content, .boardView .detail');
    if (!article) return;

    let info = null;
    let box  = article.querySelector('.linked-product-box[data-lp="product"]');
    if (box) {
      info = {
        no:    box.getAttribute('data-prno')    || '',
        name:  box.getAttribute('data-prname')  || '',
        brand: box.getAttribute('data-prbrand') || '',
        img:   box.getAttribute('data-primg')   || '',
        url:   box.getAttribute('data-prurl')   || (box.getAttribute('data-prno') ? '/product/detail.html?product_no='+encodeURIComponent(box.getAttribute('data-prno')) : '')
      };
    }

    // <!-- lp ... -->
    if (!info) {
      const html = article.innerHTML;
      const m = html && html.match(/<!--\s*lp\s+([^>]*)-->/i);
      if (m) {
        const attrs = {};
        (m[1]||'').replace(/(\w+)=["']([^"']*)["']/g, (_,k,v)=>{ attrs[k]=v; return ''; });
        if (attrs.prno || attrs.prname) {
          info = {
            no: attrs.prno||'',
            name: attrs.prname||'',
            brand: attrs.prbrand||'',
            img: attrs.primg||'',
            url: attrs.prurl || (attrs.prno ? '/product/detail.html?product_no='+encodeURIComponent(attrs.prno) : '')
          };
        }
      }
    }

    if (!info) return;

    const mount = $('.relation_prd') || $('.xans-board-read .ec-base-table.gLayoutFixed')?.parentNode || article;
    const card = document.createElement('div');
    card.className = 'linked-product-card';
    card.innerHTML = `
      <div class="lp-thumb">${info.img ? `<img src="${esc(info.img)}" alt="${esc(info.name)}">` : ''}</div>
      <div class="lp-meta">
        ${info.brand ? `<div class="lp-brand">${esc(info.brand)}</div>` : ``}
        <div class="lp-name">${esc(info.name)}</div>
      </div>
    `;
    mount.insertBefore(card, mount.firstChild);

    if (box) box.style.display = 'none';
  })();

  (function fillCategory(){
    const PREFIX = /^[\u200B\uFEFF\u2060\u00A0\s]*\[(.*?)\][\u200B\uFEFF\u2060\u00A0\s]*/;

    const titleEl = $('.q_title');
    const catEl   = $('.q_category');
    const dotEl   = (function(){
      const meta = $('.q_meta');
      if (!meta) return null;
      const spans = meta.querySelectorAll('span');
      return spans[1] || null;
    })();

    if (!titleEl || !catEl) return;

    let catText = (catEl.textContent || '').trim();

    if (!catText) {
      const raw = (titleEl.textContent || '').trim();
      const m = raw.match(PREFIX);
      if (m) {
        catText = m[1];
        titleEl.textContent = raw.replace(PREFIX, '');
      }
    } else {
      const raw = (titleEl.textContent || '').trim();
      if (PREFIX.test(raw)) titleEl.textContent = raw.replace(PREFIX, '');
    }

    if (catText) {
      catEl.textContent = catText;
      if (dotEl) dotEl.style.display = '';
    } else {
      if (dotEl) dotEl.style.display = 'none';
    }
  })();
});

(function () {
  const FILE_SVG = `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
    <mask id="mask0_3261_51483" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16">
        <rect width="16" height="16" fill="#D9D9D9"/>
    </mask>
    <g mask="url(#mask0_3261_51483)">
        <path d="M7.83203 9.63333V12.0897C7.83203 12.2316 7.87992 12.3504 7.9757 12.4462C8.07136 12.5418 8.19014 12.5897 8.33203 12.5897C8.47392 12.5897 8.5927 12.5418 8.68836 12.4462C8.78414 12.3504 8.83203 12.2316 8.83203 12.0897V9.63333L9.71403 10.5153C9.7637 10.5649 9.81948 10.6021 9.88136 10.6268C9.94337 10.6516 10.0054 10.6623 10.0674 10.659C10.1293 10.6556 10.1905 10.6414 10.2512 10.6167C10.3119 10.5919 10.367 10.5547 10.4167 10.5052C10.5133 10.4017 10.5633 10.2846 10.5667 10.1538C10.57 10.0231 10.52 9.90594 10.4167 9.8025L8.75387 8.13967C8.69142 8.07733 8.62559 8.03333 8.55636 8.00767C8.48714 7.982 8.41236 7.96917 8.33203 7.96917C8.2517 7.96917 8.17692 7.982 8.1077 8.00767C8.03848 8.03333 7.97264 8.07733 7.9102 8.13967L6.24736 9.8025C6.14825 9.90172 6.09936 10.0178 6.1007 10.1507C6.10192 10.2836 6.15425 10.4017 6.2577 10.5052C6.36114 10.6017 6.47825 10.6517 6.60903 10.6552C6.7397 10.6585 6.85675 10.6085 6.9602 10.5052L7.83203 9.63333ZM4.5372 14.6667C4.20042 14.6667 3.91536 14.55 3.68203 14.3167C3.4487 14.0833 3.33203 13.7983 3.33203 13.4615V3.20517C3.33203 2.86839 3.4487 2.58333 3.68203 2.35C3.91536 2.11667 4.20042 2 4.5372 2H9.33337C9.49403 2 9.64853 2.03122 9.79686 2.09367C9.94509 2.156 10.0739 2.24189 10.1834 2.35133L12.9807 5.14867C13.0901 5.25811 13.176 5.38694 13.2384 5.53517C13.3008 5.6835 13.332 5.838 13.332 5.99867V13.4615C13.332 13.7983 13.2154 14.0833 12.982 14.3167C12.7487 14.55 12.4636 14.6667 12.1269 14.6667H4.5372ZM9.33203 5.39733V3H4.5372C4.48586 3 4.43886 3.02139 4.3962 3.06417C4.35342 3.10683 4.33203 3.15383 4.33203 3.20517V13.4615C4.33203 13.5128 4.35342 13.5598 4.3962 13.6025C4.43886 13.6453 4.48586 13.6667 4.5372 13.6667H12.1269C12.1782 13.6667 12.2252 13.6453 12.2679 13.6025C12.3106 13.5598 12.332 13.5128 12.332 13.4615V6H9.9347C9.76281 6 9.61942 5.9425 9.50453 5.8275C9.38953 5.71261 9.33203 5.56922 9.33203 5.39733Z" fill="#454545"/>
    </g>
    </svg>`;
  const OPEN_SVG = `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
    <mask id="mask0_3261_51487" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16">
        <rect width="16" height="16" fill="#D9D9D9"/>
    </mask>
    <g mask="url(#mask0_3261_51487)">
        <path d="M11.0563 5.7025L4.8345 11.918C4.74217 12.0102 4.62617 12.0553 4.4865 12.0532C4.34672 12.0511 4.23067 12.0038 4.13833 11.9115C4.04611 11.8192 4 11.7042 4 11.5667C4 11.4291 4.04611 11.3142 4.13833 11.2218L10.3538 5H4.88967C4.748 5 4.62922 4.95206 4.53333 4.85617C4.43756 4.76028 4.38967 4.6415 4.38967 4.49983C4.38967 4.35806 4.43756 4.23933 4.53333 4.14367C4.62922 4.04789 4.748 4 4.88967 4H11.4537C11.6244 4 11.7676 4.05772 11.883 4.17317C11.9986 4.28872 12.0563 4.43183 12.0563 4.6025V11.1667C12.0563 11.3083 12.0084 11.4271 11.9125 11.5228C11.8166 11.6187 11.6978 11.6667 11.5562 11.6667C11.4144 11.6667 11.2956 11.6187 11.1998 11.5228C11.1042 11.4271 11.0563 11.3083 11.0563 11.1667V5.7025Z" fill="#767676"/>
    </g>
    </svg>`;

  function detectFileDataBase(){
    const probe = document.querySelector('.detail img[src*="/file_data/"], .q_content_main img[src*="/file_data/"]');
    if (probe) {
      const u = new URL(probe.getAttribute('src'), location.origin);
      const i = u.pathname.indexOf('/file_data/');
      if (i >= 0) {
        const segs = u.pathname.slice(i+1).split('/');
        if (segs.length >= 2) {
          return `${location.origin}/file_data/${segs[1]}/`;
        }
      }
    }

    const mallGuess = location.hostname.split('.')[0];
    return `${location.origin}/file_data/${mallGuess}/`;
  }

  const FILEDATA_BASE = detectFileDataBase();

  function getViewUrlFrom(a){
    const oc = a.getAttribute('onclick') || '';
    let realname = '';
    const m = oc.match(/download\/\?([^'"]+)/i);
    if (m) {
      const q = new URLSearchParams(m[1]);
      realname = (q.get('realname') || '').trim();
    }
    if (!realname) {
      try {
        const href = a.getAttribute('href') || '';
        const q = new URL(href, location.origin).searchParams;
        realname = (q.get('realname') || '').trim();
      } catch {}
    }

    if (!realname) return a.getAttribute('href') || '#';
    if (/^https?:\/\//i.test(realname)) return realname;
    if (realname.startsWith('/')) return location.origin + realname;

    return FILEDATA_BASE + realname.replace(/^\/+/, '');
  }

  function pill(name, url){
    const el = document.createElement('a');
    el.className = 'file-pill';
    el.href = url;
    el.target = '_blank';
    el.rel = 'noopener';
    el.innerHTML = `
      <div class="file-left">
        <span class="file-ico" aria-hidden="true">${FILE_SVG}</span>
        <span class="file-name">${name}</span>
      </div>
      <span class="file-open" aria-hidden="true">${OPEN_SVG}</span>
    `;
    return el;
  }

  function enhanceFileList(){
    const box = document.querySelector('.file_list');
    if (!box) return;
    const links = Array.from(box.querySelectorAll('a'));
    if (!links.length) return;

    box.textContent = '';
    for (const a of links){
      const name = (a.textContent || '').trim();
      const viewUrl = getViewUrlFrom(a);
      box.appendChild(pill(name, viewUrl));
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', enhanceFileList);
  } else {
    enhanceFileList();
  }
})();

document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.qna_a_wrap').forEach(wrap => {
    const content = wrap.querySelector('.a_content_main');
    if (!content) return;

    const txt = (content.textContent || '').trim();
    const hasMedia = content.querySelector('img, video, iframe, embed, object');

    if (!txt && !hasMedia) {
      wrap.style.display = 'none';
    }
  });
});

document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.q_date').forEach(span => {
    const full = (span.textContent || '').trim();
    const m = full.match(/^(\d{4}-\d{2}-\d{2})/);
    if (m) {
      span.textContent = m[1];
    }
  });
});
</script>

<style>
#qna_header {
    position: relative;
    justify-content: center;
    display: flex;
    width: 100%;
    padding: 16px;
    align-items: center;
    background-color: #FFF;
}

#qna_header .header_back {
    position: absolute;
    left: 16px;
    top: 16px;
    width: 24px;
}

#qna_header .header_back img {
    width: 100%;
}

#qna_header p {
    color: var(--G-800, var(--Gray-800, #393939));
    text-align: center;
    font-size: 16px;
    font-style: normal;
    font-weight: 600;
    line-height: 22px; /* 137.5% */
    letter-spacing: -0.32px;
}

.qna_tab {
    display: flex;
    align-items: center;
    border-bottom: 1px solid var(--Gray-200, #E3E3E3);
    background: #FFF;
    margin: -16px -16px 0;
}

.qna_write, .qna_list {
    display: flex;
    width: 50%;
    height: 48px;
    padding: 14px 24px;
    justify-content: center;
    align-items: center;
    gap: 10px;
    flex: 1 0 0;
    color: var(--G-600, var(--Gray-600, #767676));
    text-align: center;
    font-size: 15px;
    font-style: normal;
    font-weight: 600;
    line-height: 20px; /* 133.333% */
    letter-spacing: -0.3px;
}

.qna_list.active {
    border-bottom: 2px solid var(--Olive-Green, #1B8862);
    color: var(--Olive-Green, #1B8862);
    text-align: center;
    font-size: 15px;
    font-style: normal;
    font-weight: 600;
    line-height: 20px; /* 133.333% */
    letter-spacing: -0.3px;
}

.qna_q_wrap {
    display: flex;
    width: 100%;
    padding: 16px;
    align-items: flex-start;
    gap: 10px;
    border-radius: 12px;
    background: var(--G-0, #FFF);
}

.q_data_list {
    width: 100%;
}

.q_before {
    overflow: hidden;
    color: var(--Oilve-Green, #1B8862);
    text-overflow: ellipsis;
    font-size: 16px;
    font-style: normal;
    font-weight: 600;
    line-height: 22px; /* 137.5% */
    letter-spacing: -0.32px;
    flex-shrink: 0;
}

.q_title {
   overflow: hidden;
    color: var(--G-900, #181818);
    text-overflow: ellipsis;
    font-size: 15px;
    font-style: normal;
    font-weight: 600;
    line-height: 20px; /* 133.333% */
    letter-spacing: -0.3px; 
}

.q_meta {
    display: flex;
    align-items: center;
    gap: 6px;
    margin: 4px 0 12px;
}

.q_category {
    color: var(--Primary-300, #5BA071);
    font-size: 12px;
    font-style: normal;
    font-weight: 500;
    line-height: 18px; /* 150% */
    letter-spacing: -0.24px;
}

.q_date, .q_dot {
    color: var(--G-500, var(--Gray-500, #888));
    font-size: 12px;
    font-style: normal;
    font-weight: 500;
    line-height: 18px; /* 150% */
    letter-spacing: -0.24px;
}

.q_content_main p {
    color: var(--G-900, #181818);
    font-size: 13px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px; /* 153.846% */
    letter-spacing: -0.26px;
}

.linked-product-card {
    display: flex;
    width: 100%;
    padding: 10px;
    align-items: center;
    gap: 12px;
    align-self: stretch;
    border-radius: 12px;
    background: var(--Gray-50, #F8F8F8);
    margin-top: 12px;
}

.lp-thumb {
    width: 48px;
    height: 48px;
    aspect-ratio: 1/1;
    display: flex;
}

.lp-thumb img {
    width: 100%;
    border-radius: 8px;
    background: url(<path-to-image>) lightgray 50% / cover no-repeat;
    aspect-ratio: 1/1;
}

.lp-brand {
    color: var(--G-500, var(--Gray-500, #888));
    font-size: 11px;
    font-style: normal;
    font-weight: 400;
    line-height: 16px; /* 145.455% */
    letter-spacing: -0.22px;
}

.lp-name {
    color: var(--G-900, #181818);
    font-size: 12px;
    font-style: normal;
    font-weight: 600;
    line-height: 18px; /* 150% */
    letter-spacing: -0.24px;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
}

.qna_a_wrap {
    display: flex;
    width: 100%;
    padding: 16px;
    align-items: flex-start;
    gap: 10px;
    margin-top: 12px;
    border-radius: 12px;
    background: var(--G-0, #FFF);
}

.a_before {
    overflow: hidden;
    color: var(--Point, #F46200);
    text-overflow: ellipsis;
    font-size: 16px;
    font-style: normal;
    font-weight: 600;
    line-height: 22px; /* 137.5% */
    letter-spacing: -0.32px;
    flex-shrink: 0;
}

.a_content_main p {
    color: var(--G-900, #181818);
    font-size: 13px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px; /* 153.846% */
    letter-spacing: -0.26px;
}

.file_list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 12px;
}

.file-pill {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 4px;
    padding: 8px 10px;
    border-radius: 8px;
    border: 1px solid var(--G-300, #D9D9D9);
    background: #fff;
    cursor: pointer;
    transition: border-color .18s ease, box-shadow .18s ease;
}

.file-left {
    display: flex;
    align-items: center;
    gap: 4px;
    min-width: 0;
}

.file-ico {
    display: inline-flex;
    width: 16px;
    height: 16px;
    flex: 0 0 16px;
}

.file-name,
.file-size {
    color: var(--G-700, #454545);
    font-family: Pretendard;
    font-size: 11px;
    font-style: normal;
    font-weight: 400;
    line-height: 16px; /* 145.455% */
    letter-spacing: -0.22px;
}

.file-open {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  flex: 0 0 16px;
  border-radius: 6px;
}
</style>